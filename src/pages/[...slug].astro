---
import WorkLayout from "@layouts/workLayout.astro";
import WaterfallGallery from "@components/WaterfallGallery.astro";
import { getWorks } from "../scripts/_getWorks";
import type { GalleryImage } from "../types/gallery";

export async function getStaticPaths() {
  const pages = [
    {
      slug: "Turpan",
      work: "tu",
      route: "Turpan",
    },
    {
      slug: "Unnoticed",
      work: "un",
      route: "Unnoticed",
    },
    {
      slug: "Another_Landscape",
      work: "al",
      route: "Another Landscape",
    },
    // {
    //   slug: 'Never_Know_How_Much_I_Love_You',
    //   work: 'ne',
    //   route: 'Never Know How Much I Love You',
    // },
  ];
  return pages.map(({ slug, work, route }) => {
    return {
      params: { slug },
      props: { work, route },
    };
  });
}

const { work, route } = Astro.props;

const _href = Astro.url.origin;
const picList = await getWorks(work as any, _href);

// 转换为类型安全的图片数组
const images: GalleryImage[] = picList.map((p: any) => ({
  url: p.url,
  alt: "Image",
}));
---

<WorkLayout title={route}>
  <main class="workWrapper">
    <WaterfallGallery images={images} />
  </main>
</WorkLayout>
